(function(g){function k(D,E,F){var G=this;return this.on("click.pjax",D,function(I){var H=g.extend({},s(E,F));if(!H.container){H.container=g(this).attr("data-pjax")||G}l(I,H)})}function l(G,D,E){E=s(D,E);var F=G.currentTarget;if(F.tagName.toUpperCase()!=="A"){throw"$.fn.pjax or $.pjax.click requires an anchor element"}if(G.which>1||G.metaKey||G.ctrlKey||G.shiftKey||G.altKey){return}if(location.protocol!==F.protocol||location.host!==F.host){return}if(F.hash&&F.href.replace(F.hash,"")===location.href.replace(location.hash,"")){return}if(F.href===location.href+"#"){return}var H={url:F.href,container:g(F).attr("data-pjax"),target:F,fragment:null};z(g.extend({},H,E));G.preventDefault()}function q(G,D,E){E=s(D,E);var F=G.currentTarget;if(F.tagName.toUpperCase()!=="FORM"){throw"$.pjax.submit requires a form element"}var H={type:F.method.toUpperCase(),url:F.action,data:g(F).serializeArray(),container:g(F).attr("data-pjax"),target:F,fragment:null};z(g.extend({},H,E));G.preventDefault()}function z(D){D=g.extend(true,{},g.ajaxSettings,z.defaults,D);if(g.isFunction(D.url)){D.url=D.url()}var J=D.target;var I=p(D.url).hash;var E=D.context=r(D.container);if(!D.data){D.data={}}D.data._pjax=E.selector;function H(M,L){var N=g.Event(M,{relatedTarget:J});E.trigger(N,L);return !N.isDefaultPrevented()}var G;D.beforeSend=function(M,L){if(L.type!=="GET"){L.timeout=0}M.setRequestHeader("X-PJAX","true");M.setRequestHeader("X-PJAX-Container",E.selector);if(!H("pjax:beforeSend",[M,L])){return false}if(L.timeout>0){G=setTimeout(function(){if(H("pjax:timeout",[M,D])){M.abort("timeout")}},L.timeout);L.timeout=0}D.requestUrl=p(L.url).href};D.complete=function(L,M){if(G){clearTimeout(G)}H("pjax:complete",[L,M,D]);H("pjax:end",[L,D])};D.error=function(O,P,M){var L=w("",O,D);var N=H("pjax:error",[O,P,M,D]);if(D.type=="GET"&&P!=="abort"&&N){x(L.url)}};D.success=function(O,N,S,P){if(P==undefined&&g.pjax.contentCache!==null){g.pjax.contentCache[D.url]={data:O,status:N,xhr:S}}var R=(typeof g.pjax.defaults.version==="function")?g.pjax.defaults.version():g.pjax.defaults.version;var T=S.getResponseHeader("X-PJAX-Version");var M=w(O,S,D);if(R&&T&&R!==T){x(M.url);return}if(!M.contents){x(M.url);return}z.state={id:D.id||m(),url:M.url,title:M.title,container:E.selector,fragment:D.fragment,timeout:D.timeout};if(D.push||D.replace){window.history.replaceState(z.state,M.title,M.url)}if(M.title){document.title=M.title}E.html(M.contents);a(M.scripts);if(typeof D.scrollTo==="number"){g(window).scrollTop(D.scrollTo)}if((D.replace||D.push)&&window._gaq){_gaq.push(["_trackPageview"])}if(I!==""){var L=p(M.url);L.hash=I;z.state.url=L.href;window.history.replaceState(z.state,M.title,L.href);var Q=g(L.hash);if(Q.length){g(window).scrollTop(Q.offset().top)}}H("pjax:success",[O,N,S,D])};if(!z.state){z.state={id:m(),url:window.location.href,title:document.title,container:E.selector,fragment:D.fragment,timeout:D.timeout};window.history.replaceState(z.state,document.title)}var K=z.xhr;if(K&&K.readyState<4){K.onreadystatechange=g.noop;K.abort()}z.options=D;var K=null;if(g.pjax.contentCache!==null&&g.pjax.contentCache[D.url]!==undefined){var F=g.pjax.contentCache[D.url];K=z.xhr=F.xhr;D.requestUrl=p(D.url).href;setTimeout(function(){D.success(F.data,F.status,F.xhr,true);D.complete(F.xhr,"success")},0)}else{K=z.xhr=g.ajax(D)}if(K.readyState>0){if(D.push&&!D.replace){j(z.state.id,E.clone().contents());window.history.pushState(null,"",B(D.requestUrl))}H("pjax:start",[K,D]);H("pjax:send",[K,D])}return z.xhr}function v(D,E){var F={url:window.location.href,push:false,replace:true,scrollTo:false};return z(g.extend(F,s(D,E)))}function x(D){window.history.replaceState(null,"","#");window.location.replace(D)}var i=true;var C=window.location.href;var A=window.history.state;if(A&&A.container){z.state=A}function b(G){var H=G.state;if(H&&H.container){if(i&&C==H.url){return}var D=g(H.container);if(D.length){var I,F=e[H.id];if(z.state){I=z.state.id<H.id?"forward":"back";t(I,z.state.id,D.clone().contents())}var J=g.Event("pjax:popstate",{state:H,direction:I});D.trigger(J);var E={id:H.id,url:H.url,container:D,push:false,fragment:H.fragment,timeout:H.timeout,scrollTo:false};if(F){D.trigger("pjax:start",[null,E]);if(H.title){document.title=H.title}D.html(F);z.state=H;D.trigger("pjax:end",[null,E])}else{z(E)}D[0].offsetHeight}else{x(location.href)}}i=false}function d(E){var D=g.isFunction(E.url)?E.url():E.url,H=E.type?E.type.toUpperCase():"GET";var F=g("<form>",{method:H==="GET"?"GET":"POST",action:D,style:"display:none"});if(H!=="GET"&&H!=="POST"){F.append(g("<input>",{type:"hidden",name:"_method",value:H.toLowerCase()}))}var G=E.data;if(typeof G==="string"){g.each(G.split("&"),function(I,J){var K=J.split("=");F.append(g("<input>",{type:"hidden",name:K[0],value:K[1]}))})}else{if(typeof G==="object"){for(key in G){F.append(g("<input>",{type:"hidden",name:key,value:G[key]}))}}}g(document.body).append(F);F.submit()}function m(){return(new Date).getTime()}function B(D){return D.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")
}function p(E){var D=document.createElement("a");D.href=E;return D}function s(D,E){if(D&&E){E.container=D}else{if(g.isPlainObject(D)){E=D}else{E={container:D}}}if(E.container){E.container=r(E.container)}return E}function r(D){D=g(D);if(!D.length){throw"no pjax container for "+D.selector}else{if(D.selector!==""&&D.context===document){return D}else{if(D.attr("id")){return g("#"+D.attr("id"))}else{throw"cant get selector for pjax container!"}}}}function n(E,D){return E.filter(D).add(E.find(D))}function u(D){return g.parseHTML(D,document,true)}function w(G,I,E){var H={};H.url=B(I.getResponseHeader("X-PJAX-URL")||E.requestUrl);if(/<html/i.test(G)){var D=g(u(G.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]));var F=g(u(G.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]))}else{var D=F=g(u(G))}if(F.length===0){return H}H.title=n(D,"title").last().text();if(E.fragment){if(E.fragment==="body"){var J=F}else{var J=n(F,E.fragment).first()}if(J.length){H.contents=J.contents();if(!H.title){H.title=J.attr("title")||J.data("title")}}}else{if(!/<html/i.test(G)){H.contents=F}}if(H.contents){H.contents=H.contents.not(function(){return g(this).is("title")});H.contents.find("title").remove();H.scripts=n(H.contents,"script[src]").remove();H.contents=H.contents.not(H.scripts)}if(H.title){H.title=g.trim(H.title)}return H}function a(D){if(!D){return}var E=g("script[src]");D.each(function(){var G=this.src;var H=E.filter(function(){return this.src===G});if(H.length){return}var F=document.createElement("script");F.type=g(this).attr("type");F.src=g(this).attr("src");document.head.appendChild(F)})}var e={};var f=[];var h=[];function j(E,D){e[E]=D;h.push(E);while(f.length){delete e[f.shift()]}while(h.length>z.defaults.maxCacheLength){delete e[h.shift()]}}function t(F,H,E){var G,D;e[H]=E;if(F==="forward"){G=h;D=f}else{G=f;D=h}G.push(H);if(H=D.pop()){delete e[H]}}function y(){return g("meta").filter(function(){var D=g(this).attr("http-equiv");return D&&D.toUpperCase()==="X-PJAX-VERSION"}).attr("content")}function o(){g.fn.pjax=k;g.pjax=z;g.pjax.enable=g.noop;g.pjax.disable=c;g.pjax.click=l;g.pjax.submit=q;g.pjax.reload=v;g.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:y};g.pjax.contentCache={};g(window).bind("popstate.pjax",b)}function c(){g.fn.pjax=function(){return this};g.pjax=d;g.pjax.enable=o;g.pjax.disable=g.noop;g.pjax.click=g.noop;g.pjax.submit=g.noop;g.pjax.reload=function(){window.location.reload()};g(window).unbind("popstate.pjax",b)}if(g.inArray("state",g.event.props)<0){g.event.props.push("state")}g.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/);g.support.pjax?o():c()})(jQuery);